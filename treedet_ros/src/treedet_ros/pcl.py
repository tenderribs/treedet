import numpy as np

kp1 = np.array(
    [
        4.6435486e02,
        1.0982675e02,
        9.9997723e-01,
        4.5504333e02,
        1.0856831e02,
        9.9907112e-01,
        4.7389435e02,
        1.0912629e02,
        9.9970472e-01,
        4.6985754e02,
        5.3832996e01,
        9.9997497e-01,
        4.7480435e02,
        -6.9657826e-01,
        9.9908960e-01,
    ]
)
kp2 = np.array(
    [
        1.2434834e02,
        2.9013342e02,
        9.9999988e-01,
        9.9267570e01,
        2.8697916e02,
        9.9999678e-01,
        1.4815048e02,
        2.8327194e02,
        9.9994469e-01,
        1.0683840e02,
        1.4133604e02,
        9.9992496e-01,
        9.1819809e01,
        -8.6989634e-02,
        9.9827462e-01,
    ]
)

pc1 = np.array(
    [
        [4.2409873, -4.319785, 14.326159],
        [4.245208, -4.70484, 14.224178],
        [4.2403564, -5.080304, 14.090777],
        [4.392804, -4.3013496, 14.261039],
        [4.397077, -4.685812, 14.159193],
        [4.395249, -5.0645304, 14.0369215],
        [4.011006, -2.4050333, 14.891415],
        [4.461579, -3.0996444, 16.470358],
        [4.4599414, -3.524783, 16.33301],
        [4.4937706, -3.9783685, 16.328844],
        [4.147928, -2.381338, 14.770599],
        [4.187816, -2.7898397, 14.787689],
        [4.198447, -3.1824052, 14.708161],
        [4.1938233, -3.5617766, 14.574082],
        [4.198074, -3.9471219, 14.472201],
        [4.331367, -2.383719, 14.819911],
        [4.3455377, -2.7773423, 14.741456],
        [4.355377, -3.1689918, 14.658071],
        [4.3548217, -3.5517182, 14.539068],
        [4.355854, -3.9342995, 14.425933],
        [4.651909, -2.4561136, 15.326308],
        [5.5391197, -3.3938777, 18.172363],
        [5.0257287, -4.3648224, 16.05844],
        [4.8105426, -2.4406726, 15.264026],
    ]
)
pc2 = np.array(
    [
        [-1.87254870e00, 8.64992142e-01, 3.54980326e00],
        [-2.11134672e00, 8.37032437e-01, 3.96606565e00],
        [-1.83704090e00, 8.59616637e-01, 3.56912136e00],
        [-1.98806310e00, 7.95857191e-01, 3.82302952e00],
        [-1.68775856e00, 9.23445106e-01, 3.40180397e00],
        [-1.77213526e00, 8.39906514e-01, 3.52838421e00],
        [-1.91996872e00, 7.77536809e-01, 3.78360939e00],
        [-1.65557480e00, 9.19537604e-01, 3.42278028e00],
        [-1.73509479e00, 8.33968401e-01, 3.54316139e00],
        [-1.86476028e00, 7.64654100e-01, 3.76798987e00],
        [-1.62313664e00, 9.15715873e-01, 3.44344783e00],
        [-1.70287561e00, 8.30657959e-01, 3.56818366e00],
        [-1.81839252e00, 7.55638957e-01, 3.76942897e00],
        [-1.56818736e00, 8.98789525e-01, 3.41413951e00],
        [-1.65739346e00, 8.20749044e-01, 3.56441617e00],
        [-1.67693710e00, 7.04531789e-01, 3.56301951e00],
        [-1.52014959e00, 8.85825872e-01, 3.39832497e00],
        [-1.61529195e00, 8.12655568e-01, 3.56725001e00],
        [-1.61995721e00, 6.90296590e-01, 3.53368473e00],
        [-1.49234128e00, 8.85171473e-01, 3.42841077e00],
        [-1.55003297e00, 7.92305410e-01, 3.51568675e00],
        [-1.55109608e00, 6.70524657e-01, 3.47471499e00],
        [-1.59363890e00, -1.02205837e00, 3.03887725e00],
        [-1.58148777e00, -1.10692561e00, 2.99092317e00],
        [-9.21797335e-01, 5.46318054e-01, 2.15005970e00],
        [-9.38764751e-01, 4.75526601e-01, 2.16018987e00],
        [-1.50966203e00, 6.63191319e-01, 3.47630191e00],
        [-1.53915024e00, -1.01545763e00, 3.01723289e00],
        [-1.53925014e00, -1.10702610e00, 2.99354935e00],
        [-8.98112833e-01, 5.42667925e-01, 2.15624380e00],
        [-9.11789954e-01, 4.70301360e-01, 2.15927935e00],
        [-1.48939180e00, 6.65941298e-01, 3.52833605e00],
        [-1.50207853e00, -1.01887500e00, 3.02970266e00],
        [-1.49211609e00, -1.10363126e00, 2.98531342e00],
        [-8.71546090e-01, 5.37246108e-01, 2.15492749e00],
        [-8.83467019e-01, 4.64350641e-01, 2.15441275e00],
        [-1.45062470e00, 6.60228908e-01, 3.53648114e00],
        [-1.46818769e00, -1.02423739e00, 3.04878497e00],
        [-1.46825123e00, -1.11580634e00, 3.02510309e00],
        [-8.39528203e-01, 5.28242111e-01, 2.13875008e00],
        [-8.42603981e-01, 4.51209664e-01, 2.11631966e00],
        [-1.35301471e00, 6.25832915e-01, 3.39384913e00],
        [-1.44045174e00, -1.03363478e00, 3.08161235e00],
        [-1.45966470e00, -1.13922989e00, 3.09965372e00],
        [-8.17367673e-01, 5.25747955e-01, 2.14771342e00],
        [-8.20452809e-01, 4.48706836e-01, 2.12531424e00],
        [-8.30036700e-01, 3.78147244e-01, 2.12307310e00],
        [-1.35128188e00, -1.00257444e00, 2.97640991e00],
        [-7.81914353e-01, 5.14220357e-01, 2.11980391e00],
        [-7.83431649e-01, 4.37446535e-01, 2.09358835e00],
        [-7.99428523e-01, 3.71512622e-01, 2.10976624e00],
        [-6.12947285e-01, -5.25882125e-01, 1.35054660e00],
        [-7.52197564e-01, 5.06452262e-01, 2.10611868e00],
        [-7.61474967e-01, 4.35109615e-01, 2.10198641e00],
        [-7.71807075e-01, 3.66367757e-01, 2.10348845e00],
        [-6.01726413e-01, -5.31925142e-01, 1.37150836e00],
        [-7.34335780e-01, 4.29656565e-01, 2.09533167e00],
        [-7.50844359e-01, 3.64751041e-01, 2.11548996e00],
        [-2.19296265e00, 7.31819332e-01, 4.10950565e00],
        [-2.41234851e00, 6.58871472e-01, 4.50001478e00],
        [-2.14604926e00, 7.23631382e-01, 4.12146664e00],
        [-2.37206388e00, 6.53597832e-01, 4.53531456e00],
        [-2.55769873e00, 5.50219655e-01, 4.86623096e00],
        [-2.80880117e00, 4.40057188e-01, 5.31797934e00],
        [-3.03512502e00, 3.01149577e-01, 5.71701336e00],
        [-3.42258501e00, 1.49852648e-01, 6.41599369e00],
        [-4.03416967e00, -4.00504246e-02, 7.53047180e00],
        [-2.19564128e00, 7.50543118e-01, 4.32746983e00],
        [-2.29056597e00, 6.36249423e-01, 4.48867655e00],
        [-2.32762337e00, 5.00165045e-01, 4.53342628e00],
        [-2.77400374e00, 4.35583830e-01, 5.38578653e00],
        [-2.94168758e00, 2.88477838e-01, 5.68030405e00],
        [-3.35424590e00, 1.40059114e-01, 6.44723415e00],
        [-3.89902377e00, -5.16414531e-02, 7.46116590e00],
        [-4.43711472e00, -3.01032484e-01, 8.44963455e00],
        [-4.92641783e00, -6.01180434e-01, 9.32854939e00],
        [-5.51439953e00, -9.67587471e-01, 1.03835707e01],
        [-6.62395954e00, -1.50634003e00, 1.24048100e01],
        [-7.53318501e00, -2.10799861e00, 1.40277395e01],
        [-2.01424098e00, 6.93822026e-01, 4.06559181e00],
        [-2.22407794e00, 6.23422682e-01, 4.46938181e00],
        [-2.28989816e00, 4.95620251e-01, 4.57513952e00],
        [-2.72577691e00, 4.28959608e-01, 5.42840385e00],
        [-2.97891998e00, 2.91416258e-01, 5.90350056e00],
        [-3.28739095e00, 1.30567804e-01, 6.48134327e00],
        [-3.74050999e00, -6.27186522e-02, 7.33990240e00],
        [-4.37042475e00, -3.14749748e-01, 8.53737545e00],
        [-4.84827232e00, -6.17281020e-01, 9.41751671e00],
        [-5.47193670e00, -9.94380891e-01, 1.05705681e01],
        [-6.54332066e00, -1.53630042e00, 1.25705795e01],
        [-7.41808224e00, -2.13874006e00, 1.41704798e01],
        [-8.10884857e00, -2.77165627e00, 1.53907385e01],
        [-1.95110834e00, 6.79920733e-01, 4.03987026e00],
        [-2.23307204e00, 6.33698642e-01, 4.60682631e00],
        [-2.30304956e00, 5.03568113e-01, 4.72424078e00],
        [-2.63719535e00, 4.15353298e-01, 5.38794613e00],
        [-2.86752152e00, 2.77054340e-01, 5.82957697e00],
        [-3.22192168e00, 1.21365175e-01, 6.51836920e00],
        [-3.57778192e00, -7.31136799e-02, 7.20186949e00],
        [-4.29176521e00, -3.27700436e-01, 8.60313892e00],
        [-4.79188156e00, -6.35929286e-01, 9.55240154e00],
        [-5.39762354e00, -1.01627290e00, 1.07007256e01],
        [-1.64107513e00, -4.57464308e-01, 3.16149259e00],
        [-1.66635251e00, -5.59349060e-01, 3.18958926e00],
        [-8.00439835e00, -2.81517434e00, 1.55920410e01],
        [-1.65078056e00, -7.42849350e-01, 3.11112309e00],
        [-1.67378271e00, 5.85507393e-01, 3.54669619e00],
        [-1.65427291e00, 4.63112086e-01, 3.48158216e00],
        [-1.64615548e00, 3.48972857e-01, 3.44226432e00],
        [-1.65042233e00, 2.40764588e-01, 3.42879081e00],
        [-1.64640701e00, 1.33286059e-01, 3.39830351e00],
        [-1.64663398e00, 2.86013596e-02, 3.37589192e00],
        [-1.63168049e00, -7.42201582e-02, 3.32222509e00],
        [-1.62912703e00, -1.74564242e-01, 3.29517055e00],
        [-1.63284361e00, -2.73909807e-01, 3.28000689e00],
        [-1.62838066e00, -3.71046811e-01, 3.24828243e00],
        [-1.61979783e00, -4.65522319e-01, 3.20705128e00],
        [-1.61644793e00, -5.60007751e-01, 3.17837119e00],
        [-1.61783624e00, -6.54947996e-01, 3.15799642e00],
        [-1.60815096e00, -7.44735658e-01, 3.11412740e00],
        [-1.60088432e00, -8.34202290e-01, 3.07543826e00],
        [-1.61370397e00, -9.33091342e-01, 3.07655334e00],
        [-1.61811459e00, 5.73292315e-01, 3.52073598e00],
        [-1.60364366e00, 4.53758568e-01, 3.46615362e00],
        [-1.60206831e00, 3.42212111e-01, 3.44117999e00],
        [-1.60444832e00, 2.34218627e-01, 3.42409754e00],
        [-1.59536827e00, 1.26796246e-01, 3.38266635e00],
        [-1.59039783e00, 2.27761399e-02, 3.34937429e00],
        [-1.57390213e00, -7.87489265e-02, 3.29196811e00],
        [-1.57802212e00, -1.78211272e-01, 3.27944279e00],
        [-1.59176505e00, -2.77956486e-01, 3.28606582e00],
        [-1.57536983e00, -3.72534096e-01, 3.22911096e00],
        [-1.58059883e00, -4.69345152e-01, 3.21663928e00],
        [-1.55493164e00, -5.56832731e-01, 3.14148879e00],
        [-1.55621088e00, -6.50275767e-01, 3.12139177e00],
        [-1.56046748e00, -7.44318008e-01, 3.10602093e00],
        [-1.55677938e00, -8.34713638e-01, 3.07444453e00],
        [-1.56412935e00, -9.30391729e-01, 3.06534147e00],
        [-1.55042505e00, 5.56390464e-01, 3.46504736e00],
        [-1.56464612e00, 4.48127121e-01, 3.47549248e00],
        [-1.55171275e00, 3.33999157e-01, 3.42500973e00],
        [-1.54898906e00, 2.26062492e-01, 3.39697385e00],
        [-1.54316378e00, 1.20301478e-01, 3.36271834e00],
        [-1.53156936e00, 1.69930235e-02, 3.31479692e00],
        [-1.53671217e00, -8.32680836e-02, 3.30462933e00],
        [-1.54896438e00, -1.83242843e-01, 3.31033993e00],
        [-1.54406488e00, -2.80980974e-01, 3.27713966e00],
        [-1.53629649e00, -3.76425087e-01, 3.23819089e00],
        [-1.53130782e00, -4.70491379e-01, 3.20415807e00],
        [-1.51788878e00, -5.60789943e-01, 3.15401149e00],
        [-1.50732088e00, -6.49748027e-01, 3.10892749e00],
        [-1.52662218e00, -7.49543667e-01, 3.12574410e00],
        [-1.52468908e00, -8.40852857e-01, 3.09763956e00],
        [-1.50991774e00, -9.24744964e-01, 3.04297185e00],
        [-1.51647210e00, 5.52526832e-01, 3.48475337e00],
        [-1.50842619e00, 4.37101364e-01, 3.44427729e00],
        [-1.51756608e00, 3.29919904e-01, 3.44474530e00],
        [-1.50849020e00, 2.20725745e-01, 3.40204430e00],
        [-1.50268245e00, 1.15295075e-01, 3.36772346e00],
        [-1.50249398e00, 1.28994500e-02, 3.34532523e00],
        [-1.50587714e00, -8.77676904e-02, 3.33153749e00],
        [-1.49348903e00, -1.86204463e-01, 3.28253746e00],
        [-1.50159621e00, -2.84522414e-01, 3.27855515e00],
        [-1.49556458e00, -3.79867285e-01, 3.24320626e00],
        [-1.48408246e00, -4.71893072e-01, 3.19466996e00],
        [-1.50538695e00, -5.72610974e-01, 3.22026706e00],
        [-1.47367418e00, -6.54730141e-01, 3.12815285e00],
        [-1.48923099e00, -7.53216684e-01, 3.13800001e00],
        [-1.48237491e00, -8.41932416e-01, 3.09925413e00],
        [-1.47781885e00, -9.30958629e-01, 3.06567955e00],
        [-1.47773671e00, 5.46944618e-01, 3.49317145e00],
        [-1.47738183e00, 4.34238672e-01, 3.47091198e00],
        [-1.47240424e00, 3.23196560e-01, 3.43845057e00],
        [-1.46338606e00, 2.14658976e-01, 3.39562893e00],
        [-1.47004747e00, 1.11319922e-01, 3.39066648e00],
        [-1.46510899e00, 8.48663878e-03, 3.35722947e00],
        [-1.46676230e00, -9.20595899e-02, 3.33980274e00],
        [-1.46883750e00, -1.91424757e-01, 3.32372427e00],
        [-1.46720910e00, -2.89088190e-01, 3.29779100e00],
        [-1.46446478e00, -3.85186374e-01, 3.26967621e00],
        [-1.45323074e00, -4.77483720e-01, 3.22098637e00],
        [-1.45474744e00, -5.72130084e-01, 3.20325541e00],
        [-1.45746636e00, -6.66619718e-01, 3.18673158e00],
        [-1.44852674e00, -7.55308807e-01, 3.14268756e00],
        [-1.45953405e00, -8.52887094e-01, 3.14315200e00],
        [-1.44701028e00, -9.38023448e-01, 3.09163475e00],
        [-1.45523357e00, 5.48070431e-01, 3.54151845e00],
        [-1.45341158e00, 4.33914036e-01, 3.51567197e00],
        [-1.44102907e00, 3.20104748e-01, 3.46479011e00],
        [-1.45335746e00, 2.15214580e-01, 3.47358108e00],
        [-1.44014323e00, 1.07781157e-01, 3.42069912e00],
        [-1.44295049e00, 4.90671257e-03, 3.40568304e00],
        [-1.43532944e00, -9.63886678e-02, 3.36609817e00],
        [-1.43730807e00, -1.96068808e-01, 3.35002494e00],
        [-1.43568563e00, -2.94034988e-01, 3.32405186e00],
        [-1.44855547e00, -3.93816739e-01, 3.33256245e00],
        [-1.44230676e00, -4.88718182e-01, 3.29456019e00],
        [-1.42812312e00, -5.79575121e-01, 3.24019957e00],
        [-1.44174433e00, -6.79157138e-01, 3.24895954e00],
        [-1.42674541e00, -7.66153693e-01, 3.19015360e00],
        [-1.42332888e00, -8.57102156e-01, 3.15829968e00],
        [-1.43468773e00, -9.56259072e-01, 3.16000009e00],
        [-1.42182827e00, 5.45057774e-01, 3.56398821e00],
        [-1.41415036e00, 4.28739458e-01, 3.52336955e00],
        [-1.42833447e00, 3.22060078e-01, 3.53898072e00],
        [-1.43601704e00, 2.14619622e-01, 3.53685617e00],
        [-1.41869736e00, 1.05343461e-01, 3.47274756e00],
        [-1.41697001e00, 1.21542113e-03, 3.44662881e00],
        [-2.87603092e00, -1.35414824e-01, 7.02487087e00],
        [-2.88737750e00, -3.36715549e-01, 7.01121044e00],
        [-2.94937015e00, -5.44744194e-01, 7.11794233e00],
        [-2.95643735e00, -7.46376455e-01, 7.09040260e00],
        [-2.94745016e00, -9.41891909e-01, 7.02100277e00],
        [-2.93968654e00, -1.13564754e00, 6.95878696e00],
        [-2.92809081e00, -1.32506979e00, 6.88451004e00],
        [-2.94180703e00, -1.52360046e00, 6.86716413e00],
        [-2.92752171e00, -1.70778334e00, 6.78393269e00],
        [-6.22968972e-01, -4.85001266e-01, 1.37109816e00],
        [-1.40782177e00, 5.50406158e-01, 3.63791060e00],
        [-1.39616001e00, 4.30949777e-01, 3.58626556e00],
        [-1.94341087e00, 4.63973135e-01, 4.98835945e00],
        [-2.19234228e00, 3.60897839e-01, 5.60245419e00],
        [-2.32232952e00, 2.10384503e-01, 5.90467262e00],
        [-2.50828290e00, 4.66340892e-02, 6.34404659e00],
        [-2.75865149e00, -1.42364755e-01, 6.94246578e00],
        [-2.86501670e00, -3.49882931e-01, 7.17066288e00],
        [-3.43964100e00, -6.47005498e-01, 8.56851482e00],
        [-4.65626764e00, -1.17057014e00, 1.15518694e01],
        [-5.19403172e00, -1.65055156e00, 1.28089352e01],
        [-6.59708881e00, -2.52000332e00, 1.61893196e01],
        [-7.40985584e00, -3.31605887e00, 1.80736752e01],
        [-2.81675363e00, -1.50721598e00, 6.77714252e00],
        [-6.05581820e-01, -4.43196803e-01, 1.38884294e00],
        [-6.05720282e-01, -4.86894369e-01, 1.37790143e00],
        [-1.52144206e00, 6.10926688e-01, 4.06077766e00],
        [-1.79754567e00, 5.79233289e-01, 4.78076172e00],
        [-1.91316354e00, 4.64036286e-01, 5.06427383e00],
        [-2.04769135e00, 3.37976724e-01, 5.39324808e00],
        [-2.16942739e00, 1.93112358e-01, 5.68536949e00],
        [-2.43799257e00, 3.93369123e-02, 6.35840797e00],
        [-2.65749645e00, -1.49301440e-01, 6.89580679e00],
        [-2.81388354e00, -3.60484481e-01, 7.26322651e00],
        [-3.37219620e00, -6.60692155e-01, 8.66294670e00],
        [-4.51972580e00, -1.18012691e00, 1.15616980e01],
        [-5.09552193e00, -1.67687500e00, 1.29574842e01],
        [-5.75686646e00, -2.28396535e00, 1.45599203e01],
        [-7.25647736e00, -3.35505128e00, 1.82507877e01],
        [-5.87729454e-01, -4.01070088e-01, 1.40538406e00],
        [-5.94099164e-01, -4.48447406e-01, 1.40997720e00],
        [-5.82569897e-01, -4.84939814e-01, 1.37012208e00],
        [-7.86846697e-01, 3.03775221e-01, 2.14325571e00],
        [-1.73400581e00, 5.68843484e-01, 4.75815916e00],
        [-1.80833352e00, 4.44119632e-01, 4.93788099e00],
        [-1.93608224e00, 3.21267724e-01, 5.26047802e00],
        [-2.10772300e00, 1.86615840e-01, 5.70005846e00],
        [-2.37871337e00, 3.26969884e-02, 6.40204096e00],
        [-2.59089947e00, -1.57019854e-01, 6.93786192e00],
        [-2.77230144e00, -3.72215360e-01, 7.38547802e00],
        [-3.26813459e00, -6.67919219e-01, 8.66346836e00],
        [-4.40312719e00, -1.19423294e00, 1.16221962e01],
        [-4.99444151e00, -1.70302296e00, 1.31054039e01],
        [-5.64359426e00, -2.31679463e00, 1.47288427e01],
        [-5.69445610e-01, -3.58614802e-01, 1.42070591e00],
        [-5.83121061e-01, -4.09675449e-01, 1.44480193e00],
        [-5.60967028e-01, -4.40847158e-01, 1.37643516e00],
        [-5.48317194e-01, -4.75273639e-01, 1.33311915e00],
        [-1.62051940e00, 6.83433890e-01, 4.61521101e00],
        [-1.67107022e00, 5.58672905e-01, 4.73476791e00],
        [-1.75764406e00, 4.38945800e-01, 4.95647383e00],
        [-1.75818181e00, 2.91435391e-01, 4.93032026e00],
        [-2.05662870e00, 1.81551903e-01, 5.74422979e00],
        [-2.22735143e00, 2.26577520e-02, 6.18899775e00],
        [-2.27236366e00, -1.54985502e-01, 6.27910471e00],
        [-2.70950079e00, -3.81758839e-01, 7.45501661e00],
        [-3.07176566e00, -6.57331645e-01, 8.40767288e00],
        [-4.36772156e00, -1.22957230e00, 1.19060993e01],
        [-4.90860605e00, -1.73497224e00, 1.33011465e01],
        [-5.56993246e00, -2.36681604e00, 1.50121918e01],
        [-5.72685242e-01, -3.70276868e-01, 1.48242998e00],
        [-5.51568329e-01, -4.03848559e-01, 1.41442537e00],
        [-5.45170307e-01, -4.43425864e-01, 1.38626850e00],
        [-5.57679236e-01, -4.95155007e-01, 1.40815401e00],
        [-1.96196806e00, 1.71569631e-01, 5.66322470e00],
        [-2.18504882e00, 1.71504691e-02, 6.27601194e00],
        [-2.21562934e00, -1.61827445e-01, 6.32874870e00],
        [-2.75498962e00, -4.04315472e-01, 7.83723545e00],
        [-3.09541583e00, -6.88179076e-01, 8.75889874e00],
        [-4.29898739e00, -1.25743032e00, 1.21116323e01],
        [-4.81519604e00, -1.76543295e00, 1.34853153e01],
        [-5.48316300e-01, -3.23701501e-01, 1.48177838e00],
        [-5.49293160e-01, -3.69367301e-01, 1.47387755e00],
        [-5.35452008e-01, -4.06305552e-01, 1.42419863e00],
        [-5.25210857e-01, -4.43373799e-01, 1.38494885e00],
        [-5.19941032e-01, -4.82440770e-01, 1.35963094e00],
        [-5.25237608e00, -2.39923024e00, 1.51337738e01],
        [-5.22258282e-01, -3.66371036e-01, 1.45386326e00],
        [-5.06205201e-01, -4.01038319e-01, 1.39677703e00],
        [-5.07944226e-01, -4.44992483e-01, 1.39076591e00],
        [-4.65125769e-01, -4.56051975e-01, 1.25932229e00],
        [-5.06566107e-01, -4.13409323e-01, 1.45444572e00],
    ]
)


def set_axes_equal(ax):
    """
    Make axes of 3D plot have equal scale so that spheres appear as spheres,
    cubes as cubes, etc.

    Input
      ax: a matplotlib axis, e.g., as output from plt.gca().
    """

    x_limits = ax.get_xlim3d()
    y_limits = ax.get_ylim3d()
    z_limits = ax.get_zlim3d()

    x_range = abs(x_limits[1] - x_limits[0])
    x_middle = np.mean(x_limits)
    y_range = abs(y_limits[1] - y_limits[0])
    y_middle = np.mean(y_limits)
    z_range = abs(z_limits[1] - z_limits[0])
    z_middle = np.mean(z_limits)

    # The plot bounding box is a sphere in the sense of the infinity
    # norm, hence I call half the max range the plot radius.
    plot_radius = 0.5 * max([x_range, y_range, z_range])

    ax.set_xlim3d([x_middle - plot_radius, x_middle + plot_radius])
    ax.set_ylim3d([y_middle - plot_radius, y_middle + plot_radius])
    ax.set_zlim3d([z_middle - plot_radius, z_middle + plot_radius])
